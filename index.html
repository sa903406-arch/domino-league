<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Domino League</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, onSnapshot } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

window.firebaseConfig = {
  apiKey: "PUT_API_KEY_HERE",
  authDomain: "PUT_DOMAIN_HERE",
  projectId: "PUT_PROJECT_ID",
  storageBucket: "PUT_BUCKET",
  messagingSenderId: "PUT_SENDER_ID",
  appId: "PUT_APP_ID"
};

window.app = initializeApp(firebaseConfig);
window.db = getFirestore(app);
</script>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
body{margin:0;font-family:Tahoma;background:#f2f2f2}
header{background:#111;color:#fff;padding:12px;text-align:center}
nav{display:flex;background:#222}
nav button{flex:1;color:#fff;background:none;border:none;padding:10px}
nav button.active{background:#444}
.container{padding:15px}
.card{background:#fff;padding:15px;margin-bottom:15px;border-radius:8px}
.hidden{display:none}
input,button{width:100%;padding:8px;margin-top:8px}
button{background:#007bff;color:#fff;border:none;border-radius:5px}
.leader,.season{display:flex;align-items:center;border-bottom:1px solid #ddd;padding:8px 0}
img{width:45px;height:45px;border-radius:50%;margin-left:10px}
</style>
</head>

<body>

<header>ğŸ† Domino League</header>

<nav>
<button onclick="show('home')" class="active">Ø§Ù„ØªØ±ØªÙŠØ¨</button>
<button onclick="show('seasons')">Ø§Ù„Ù…ÙˆØ§Ø³Ù…</button>
<button onclick="show('admin')">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
</nav>

<div class="container">

<div id="home" class="page">
  <div class="card">
    <h3>Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ø§Ù…</h3>
    <div id="leaders"></div>
    <button onclick="share()">ğŸ“¸ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØªØ±ØªÙŠØ¨</button>
  </div>
</div>

<div id="seasons" class="page hidden">
  <div class="card">
    <h3>ğŸ† Ø£Ø¨Ø·Ø§Ù„ Ø§Ù„Ù…ÙˆØ§Ø³Ù…</h3>
    <div id="seasonList"></div>
  </div>
</div>

<div id="admin" class="page hidden">
  <div class="card" id="loginBox">
    <h3>ğŸ” Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±</h3>
    <input id="pass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
    <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
  </div>

  <div class="card hidden" id="panel">
    <h3>â• Ø¥Ø¶Ø§ÙØ© Ø¨Ø·Ù„ Ù…ÙˆØ³Ù…</h3>
    <input id="year" placeholder="2024">
    <input id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨">
    <input id="img" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©">
    <input id="points" placeholder="Ø§Ù„Ù†Ù‚Ø§Ø·">
    <button onclick="addSeason()">Ø­ÙØ¸</button>
  </div>
</div>

</div>

<script type="module">
import { collection, addDoc, getDocs, onSnapshot } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

let adminUnlocked=false;

/* ØªÙ†Ù‚Ù„ */
window.show=id=>{
 document.querySelectorAll('.page').forEach(p=>p.classList.add('hidden'));
 document.getElementById(id).classList.remove('hidden');
}

/* ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ */
window.login=async()=>{
 const snap=await getDocs(collection(db,"admin"));
 snap.forEach(d=>{
  if(d.data().password===pass.value){
    adminUnlocked=true;
    loginBox.classList.add("hidden");
    panel.classList.remove("hidden");
  }
 });
 if(!adminUnlocked) alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©");
}

/* Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ³Ù… */
window.addSeason=async()=>{
 if(!adminUnlocked) return;
 await addDoc(collection(db,"seasons"),{
   year:year.value,
   name:name.value,
   img:img.value,
   points:points.value
 });
 alert("ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©");
}

/* ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ø³Ù… */
onSnapshot(collection(db,"seasons"),snap=>{
 seasonList.innerHTML="";
 snap.forEach(d=>{
  const s=d.data();
  seasonList.innerHTML+=`
   <div class="season">
    <img src="${s.img}">
    <div>
      <b>Ù…ÙˆØ³Ù… ${s.year}</b><br>
      ${s.name} â€“ ${s.points} Ù†Ù‚Ø·Ø©
    </div>
   </div>`;
 });
});

/* ØªØ±ØªÙŠØ¨ ØªØ¬Ø±ÙŠØ¨ÙŠ */
const demo=[
 {name:"Ø¹Ù„ÙŠ",points:30,img:"https://i.pravatar.cc/100?1"},
 {name:"Ø­Ø³Ù†",points:25,img:"https://i.pravatar.cc/100?2"}
];
demo.forEach(p=>{
 leaders.innerHTML+=`
 <div class="leader">
  <img src="${p.img}">
  <div>${p.name} â€“ ${p.points}</div>
 </div>`;
});

/* Ù…Ø´Ø§Ø±ÙƒØ© */
window.share=()=>{
 html2canvas(leaders,{scale:2}).then(c=>{
  const a=document.createElement("a");
  a.href=c.toDataURL();
  a.download="ranking.png";
  a.click();
 });
}
</script>

</body>
</html>
